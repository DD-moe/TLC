<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QTL TLC Web App</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/favicon-64x64.png" sizes="64x64" type="image/png">
</head>
<body>
    <div class="container">
        <header>
            <h1>QTL TLC Web App</h1>
        </header>

        <section class="button-container">
            <nav>
                <ul>
                    <li><a href="/TLC/start/load.html">load images</a></li>
                    <li><a href="/TLC/start/settings.html">settings</a></li>
                    <li><a href="/TLC/start/normalise.html">normalise</a></li>
                    <li><a href="/TLC/start/area.html">select detection area</a></li>
                    <li><a href="/TLC/start/cropp.html">cropp selected area</a></li>
                    <li><a href="/TLC">main menu</a></li>
                </ul>
            </nav>
        </section>
    </div>
    <script>
        const DB_NAME1 = "ParametryDB";
        const STORE_NAME1 = "parametry";
        const KEY1 = "jsonData";
        let db1;

        const DB_NAME2 = "ImageDB";
        const STORE_NAME2 = "images";
        let db2;

        // Helper function to initialize IndexedDB and create object stores if necessary
        async function initDB(dbName, storeName) {
            return new Promise((resolve, reject) => {
                const dbRequest = indexedDB.open(dbName, 1);

                dbRequest.onupgradeneeded = (event) => {
                    let database = event.target.result;
                    if (!database.objectStoreNames.contains(storeName)) {
                        database.createObjectStore(storeName);
                    }
                };

                dbRequest.onsuccess = (event) => {
                    const db = event.target.result;
                    console.log(`${dbName} initialized successfully`);
                    resolve(db);
                };

                dbRequest.onerror = (event) => {
                    console.error(`Error initializing ${dbName}:`, event.target.error);
                    reject(event.target.error);
                };
            });
        }

        // Async function to initialize both databases
        async function initializeDatabases() {
            try {
                // Wait for both databases to be initialized
                const [db1Instance, db2Instance] = await Promise.all([
                    initDB(DB_NAME1, STORE_NAME1),
                    initDB(DB_NAME2, STORE_NAME2)
                ]);

                // Assign the instances to global variables
                db1 = db1Instance;
                db2 = db2Instance;

                // Perform your operations on the databases here
                loadJSON(); // Example function for loading data from db1
            } catch (error) {
                console.error("Error initializing databases:", error);
            }
        }

        // Call the async function to initialize databases
        initializeDatabases();

    </script>
</body>
</html>

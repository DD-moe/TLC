<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wybór parametrów oblicznych</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Twoja biblioteka params.js -->
  <script src="https://git.1ioe.top/TLC/v5/params.js"></script>
</head>    
<body class="bg-light">
  <div class="container py-5">
    <h2 class="mb-4">📋 Ustawienia</h2>
    <ul id="dynamicFormList" class="list-group"></ul>
    <button class="btn btn-primary" onclick="saveParams()">Zapisz</button>
    <button class="btn btn-primary" onclick="defaultParams()">ustaw domyślne parametry</button>  
    <div id="checkbox-container" class="row row-cols-2 g-2 mb-3"></div>
    <button onclick="updateIgnoredParams('outputParams')" class="btn btn-primary">zastosuj wybór parametrów</button>
  </div>

  <!-- Bootstrap 5 JS (opcjonalnie jeśli używasz komponentów JS) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Skrypt używający biblioteki params.js -->
  <script>
  // Definiowanie listy kluczy i callbacków do nasłuchiwania zmian w localStorage
  window.__watchList = [
    ['countedParams', (event) => {
        console.log(`Zmieniono parametr tolerance na: ${event.newValue}`);
      // Możesz np. zaktualizować UI
    }]
  ];

    // parametry
    const inputs = [
        ["x", "", "checkbox", "x"],
        ["y", "", "checkbox", "y"],
        ["width", "", "checkbox", "width"],
        ["height", "", "checkbox", "height"],
        ["spotSum", "", "checkbox", "spotSum"],
        ["spotSurface", "", "checkbox", "spotSurface"],
        ["spotAverage", "", "checkbox", "spotAverage"],
        ["maxIntensity", "", "checkbox", "maxIntensity"],
        ["maxX", "", "checkbox", "maxX"],
        ["maxY", "", "checkbox", "maxY"],
        ["spotSumPercent", "", "checkbox", "spotSumPercent"],
        ["spotSurfacePercent", "", "checkbox", "spotSurfacePercent"],
        ["spotAveragePercent", "", "checkbox", "spotAveragePercent"],
        ["maxIntensityPercent", "", "checkbox", "maxIntensityPercent"],
        ["startLineX", "", "checkbox", "startLineX"],
        ["endLineX", "", "checkbox", "endLineX"],
        ["startLineY", "", "checkbox", "startLineY"],
        ["endLineY", "", "checkbox", "endLineY"],
        ["xTrackWidth", "", "checkbox", "xTrackWidth"],
        ["yTrackWidth", "", "checkbox", "yTrackWidth"],
        ["xPeakonTrack", "", "checkbox", "xPeakonTrack"],
        ["yPeakonTrack", "", "checkbox", "yPeakonTrack"],
        ["xRF", "", "checkbox", "xRF"],
        ["yRF", "", "checkbox", "yRF"],
        ["xK", "", "checkbox", "xK"],
        ["yK", "", "checkbox", "yK"],
        ["xRM", "", "checkbox", "xRM"],
        ["yRM", "", "checkbox", "yRM"],
        ["xW05", "", "checkbox", "xW05"],
        ["yW05", "", "checkbox", "yW05"],
        ["xW01", "", "checkbox", "xW01"],
        ["yW01", "", "checkbox", "yW01"],
        ["xW005", "", "checkbox", "xW005"],
        ["yW005", "", "checkbox", "yW005"],
        ["xW0", "", "checkbox", "xW0"],
        ["yW0", "", "checkbox", "yW0"],
        ["xW05%", "", "checkbox", "xW05%"],
        ["yW05%", "", "checkbox", "yW05%"],
        ["xW01%", "", "checkbox", "xW01%"],
        ["yW01%", "", "checkbox", "yW01%"],
        ["xW005%", "", "checkbox", "xW005%"],
        ["yW005%", "", "checkbox", "yW005%"],
        ["xA005", "", "checkbox", "xA005"],
        ["xB005", "", "checkbox", "xB005"],
        ["yA005", "", "checkbox", "yA005"],
        ["yB005", "", "checkbox", "yB005"],
        ["xA01", "", "checkbox", "xA01"],
        ["xB01", "", "checkbox", "xB01"],
        ["yA01", "", "checkbox", "yA01"],
        ["yB01", "", "checkbox", "yB01"],
        ["xAs", "", "checkbox", "xAs"],
        ["xT", "", "checkbox", "xT"],
        ["yAs", "", "checkbox", "yAs"],
        ["yT", "", "checkbox", "yT"],
        ["xHobs0", "", "checkbox", "xHobs0"],
        ["yHobs0", "", "checkbox", "yHobs0"],
        ["xHobs05", "", "checkbox", "xHobs05"],
        ["yHobs05", "", "checkbox", "yHobs05"],
        ["xNobsUSP", "", "checkbox", "xNobsUSP"],
        ["yNobsUSP", "", "checkbox", "yNobsUSP"],
        ["xNobsEPS", "", "checkbox", "xNobsEPS"],
        ["yNobsEPS", "", "checkbox", "yNobsEPS"],
        ["tracksY", "", "checkbox", "tracksY"],
        ["tracksX", "", "checkbox", "tracksX"],
        ["previousX", "", "checkbox", "previousX"],
        ["previousY", "", "checkbox", "previousY"],
        ["alphaX", "", "checkbox", "alphaX"],
        ["RSx", "", "checkbox", "RSx"],
        ["selectivityX", "", "checkbox", "selectivityX"],
        ["xRFavg", "", "checkbox", "xRFavg"],
        ["xEfficiencyUSP", "", "checkbox", "xEfficiencyUSP"],
        ["xEfficiencyEPS", "", "checkbox", "xEfficiencyEPS"],
        ["xRetention", "", "checkbox", "xRetention"],
        ["yRetention", "", "checkbox", "yRetention"],
        ["RSxUSP", "", "checkbox", "RSxUSP"],
        ["RSxEPS", "", "checkbox", "RSxEPS"],
        ["RSyUSP", "", "checkbox", "RSyUSP"],
        ["RSyEPS", "", "checkbox", "RSyEPS"]
    ];


    // generuje luistę wszystkich parametrów
    generateFormList("dynamicFormList", inputs);

    // Zakładamy, że na stronie są elementy o id: "opis", "kolor", "data"
    const formData = {
        x: 'on',
        y: 'on',
        width: 'on',
        height: 'on',
        spotSum: 'on',
        spotSurface: 'on',
        spotAverage: 'on',
        maxIntensity: 'on',
        maxX: 'on',
        maxY: 'on',
        spotSumPercent: 'on',
        spotSurfacePercent: 'on',
        spotAveragePercent: 'on',
        maxIntensityPercent: 'on',
        startLineX: 'on',
        endLineX: 'on',
        startLineY: 'on',
        endLineY: 'on',
        xTrackWidth: 'on',
        yTrackWidth: 'on',
        xPeakonTrack: 'on',
        yPeakonTrack: 'on',
        xRF: 'on',
        yRF: 'on',
        xK: 'on',
        yK: 'on',
        xRM: 'on',
        yRM: 'on',
        xW05: 'on',
        yW05: 'on',
        xW01: 'on',
        yW01: 'on',
        xW005: 'on',
        yW005: 'on',
        xW0: 'on',
        yW0: 'on',
        "xW05%": 'on',
        "yW05%": 'on',
        "xW01%": 'on',
        "yW01%": 'on',
        "xW005%": 'on',
        "yW005%": 'on',
        xA005: 'on',
        xB005: 'on',
        yA005: 'on',
        yB005: 'on',
        xA01: 'on',
        xB01: 'on',
        yA01: 'on',
        yB01: 'on',
        xAs: 'on',
        xT: 'on',
        yAs: 'on',
        yT: 'on',
        xHobs0: 'on',
        yHobs0: 'on',
        xHobs05: 'on',
        yHobs05: 'on',
        xNobsUSP: 'on',
        yNobsUSP: 'on',
        xNobsEPS: 'on',
        yNobsEPS: 'on',
        tracksY: 'on',
        tracksX: 'on',
        previousX: 'on',
        previousY: 'on',
        alphaX: 'on',
        RSx: 'on',
        selectivityX: 'on',
        xRFavg: 'on',
        xEfficiencyUSP: 'on',
        xEfficiencyEPS: 'on',
        xRetention: 'on',
        yRetention: 'on',
        RSxUSP: 'on',
        RSxEPS: 'on',
        RSyUSP: 'on',
        RSyEPS: 'on'
    };


    // Zapisz dane do localStorage
    function defaultParams() {
        saveToStorage(formData, "countedParams");    
        location.reload();
    }

    function saveParams() {
        saveInputsToLocalStorage('countedParams');
        location.reload();
    }

    // Wczytaj dane z localStorage i przypisz do inputów
    loadFromStorage("countedParams");

  </script>
</body>
</html>    